(function(){var q;q||(q={});(function(){function h(a){return 10>a?"0"+a:a}function j(a){b.lastIndex=0;return b.test(a)?'"'+a.replace(b,function(a){var d=c[a];return"string"===typeof d?d:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function g(c,d){var b,k,h,r,o=e,m,n=d[c];n&&"object"===typeof n&&"function"===typeof n.toJSON&&(n=n.toJSON(c));"function"===typeof l&&(n=l.call(d,c,n));switch(typeof n){case "string":return j(n);case "number":return isFinite(n)?""+n:"null";case "boolean":case "null":return""+
n;case "object":if(!n)return"null";e+=a;m=[];if("[object Array]"===Object.prototype.toString.apply(n)){r=n.length;for(b=0;b<r;b+=1)m[b]=g(b,n)||"null";h=0===m.length?"[]":e?"[\n"+e+m.join(",\n"+e)+"\n"+o+"]":"["+m.join(",")+"]";e=o;return h}if(l&&"object"===typeof l){r=l.length;for(b=0;b<r;b+=1)"string"===typeof l[b]&&(k=l[b],(h=g(k,n))&&m.push(j(k)+(e?": ":":")+h))}else for(k in n)Object.prototype.hasOwnProperty.call(n,k)&&(h=g(k,n))&&m.push(j(k)+(e?": ":":")+h);h=0===m.length?"{}":e?"{\n"+e+m.join(",\n"+
e)+"\n"+o+"}":"{"+m.join(",")+"}";e=o;return h}}if("function"!==typeof Date.prototype.toJSON)Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+h(this.getUTCMonth()+1)+"-"+h(this.getUTCDate())+"T"+h(this.getUTCHours())+":"+h(this.getUTCMinutes())+":"+h(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()};var d=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
b=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,e,a,c={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},l;if("function"!==typeof q.stringify)q.stringify=function(c,d,b){var h;a=e="";if("number"===typeof b)for(h=0;h<b;h+=1)a+=" ";else"string"===typeof b&&(a=b);if((l=d)&&"function"!==typeof d&&("object"!==typeof d||"number"!==typeof d.length))throw Error("JSON.stringify");return g("",{"":c})};
if("function"!==typeof q.parse)q.parse=function(a,c){function e(a,d){var b,l,g=a[d];if(g&&"object"===typeof g)for(b in g)Object.prototype.hasOwnProperty.call(g,b)&&(l=e(g,b),void 0!==l?g[b]=l:delete g[b]);return c.call(a,d,g)}var b,a=""+a;d.lastIndex=0;d.test(a)&&(a=a.replace(d,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return b=eval("("+a+")"),"function"===typeof c?e({"":b},""):b;throw new SyntaxError("JSON.parse");}})();(function(){function h(i,a,c){if(i===a)return 0!==i||1/i==1/a;if(null==i||null==a)return i===a;if(i._chain)i=i._wrapped;if(a._chain)a=a._wrapped;if(i.isEqual&&f.isFunction(i.isEqual))return i.isEqual(a);if(a.isEqual&&f.isFunction(a.isEqual))return a.isEqual(i);var d=l.call(i);if(d!=l.call(a))return!1;switch(d){case "[object String]":return i==""+a;case "[object Number]":return i!=
+i?a!=+a:0==i?1/i==1/a:i==+a;case "[object Date]":case "[object Boolean]":return+i==+a;case "[object RegExp]":return i.source==a.source&&i.global==a.global&&i.multiline==a.multiline&&i.ignoreCase==a.ignoreCase}if("object"!=typeof i||"object"!=typeof a)return!1;for(var b=c.length;b--;)if(c[b]==i)return!0;c.push(i);var b=0,e=!0;if("[object Array]"==d){if(b=i.length,e=b==a.length)for(;b--&&(e=b in i==b in a&&h(i[b],a[b],c)););}else{if("constructor"in i!="constructor"in a||i.constructor!=a.constructor)return!1;
for(var g in i)if(f.has(i,g)&&(b++,!(e=f.has(a,g)&&h(i[g],a[g],c))))break;if(e){for(g in a)if(f.has(a,g)&&!b--)break;e=!b}}c.pop();return e}var j=this,g=j._,d={},b=Array.prototype,e=Object.prototype,a=b.slice,c=b.unshift,l=e.toString,u=e.hasOwnProperty,v=b.forEach,s=b.map,k=b.reduce,A=b.reduceRight,r=b.filter,o=b.every,m=b.some,n=b.indexOf,q=b.lastIndexOf,e=Array.isArray,D=Object.keys,w=Function.prototype.bind,f=function(i){return new t(i)};if("undefined"!==typeof exports){if("undefined"!==typeof module&&
module.exports)exports=module.exports=f;exports._=f}else j._=f;f.VERSION="1.3.1";var p=f.each=f.forEach=function(i,a,c){if(null!=i)if(v&&i.forEach===v)i.forEach(a,c);else if(i.length===+i.length)for(var b=0,e=i.length;b<e&&!(b in i&&a.call(c,i[b],b,i)===d);b++);else for(b in i)if(f.has(i,b)&&a.call(c,i[b],b,i)===d)break};f.map=f.collect=function(i,a,c){var b=[];if(null==i)return b;if(s&&i.map===s)return i.map(a,c);p(i,function(i,d,e){b[b.length]=a.call(c,i,d,e)});if(i.length===+i.length)b.length=
i.length;return b};f.reduce=f.foldl=f.inject=function(i,a,c,b){var d=2<arguments.length;null==i&&(i=[]);if(k&&i.reduce===k)return b&&(a=f.bind(a,b)),d?i.reduce(a,c):i.reduce(a);p(i,function(i,e,f){d?c=a.call(b,c,i,e,f):(c=i,d=!0)});if(!d)throw new TypeError("Reduce of empty array with no initial value");return c};f.reduceRight=f.foldr=function(a,c,b,d){var e=2<arguments.length;null==a&&(a=[]);if(A&&a.reduceRight===A)return d&&(c=f.bind(c,d)),e?a.reduceRight(c,b):a.reduceRight(c);var l=f.toArray(a).reverse();
d&&!e&&(c=f.bind(c,d));return e?f.reduce(l,c,b,d):f.reduce(l,c)};f.find=f.detect=function(a,c,b){var d;B(a,function(a,i,e){if(c.call(b,a,i,e))return d=a,!0});return d};f.filter=f.select=function(a,c,b){var d=[];if(null==a)return d;if(r&&a.filter===r)return a.filter(c,b);p(a,function(a,i,e){c.call(b,a,i,e)&&(d[d.length]=a)});return d};f.reject=function(a,c,d){var b=[];if(null==a)return b;p(a,function(a,i,e){c.call(d,a,i,e)||(b[b.length]=a)});return b};f.every=f.all=function(a,c,b){var e=!0;if(null==
a)return e;if(o&&a.every===o)return a.every(c,b);p(a,function(a,i,f){if(!(e=e&&c.call(b,a,i,f)))return d});return e};var B=f.some=f.any=function(a,c,b){c||(c=f.identity);var e=!1;if(null==a)return e;if(m&&a.some===m)return a.some(c,b);p(a,function(a,i,f){if(e||(e=c.call(b,a,i,f)))return d});return!!e};f.include=f.contains=function(a,c){var b=!1;if(null==a)return b;return n&&a.indexOf===n?-1!=a.indexOf(c):b=B(a,function(a){return a===c})};f.invoke=function(i,c){var b=a.call(arguments,2);return f.map(i,
function(a){return(f.isFunction(c)?c||a:a[c]).apply(a,b)})};f.pluck=function(a,c){return f.map(a,function(a){return a[c]})};f.max=function(a,c,b){if(!c&&f.isArray(a)&&a[0]===+a[0])return Math.max.apply(Math,a);if(!c&&f.isEmpty(a))return-Infinity;var d={computed:-Infinity};p(a,function(a,i,e){i=c?c.call(b,a,i,e):a;i>=d.computed&&(d={value:a,computed:i})});return d.value};f.min=function(a,c,b){if(!c&&f.isArray(a)&&a[0]===+a[0])return Math.min.apply(Math,a);if(!c&&f.isEmpty(a))return Infinity;var d=
{computed:Infinity};p(a,function(a,i,e){i=c?c.call(b,a,i,e):a;i<d.computed&&(d={value:a,computed:i})});return d.value};f.shuffle=function(a){var c=[],b;p(a,function(a,i){0==i?c[0]=a:(b=Math.floor(Math.random()*(i+1)),c[i]=c[b],c[b]=a)});return c};f.sortBy=function(a,c,b){return f.pluck(f.map(a,function(a,i,d){return{value:a,criteria:c.call(b,a,i,d)}}).sort(function(a,i){var c=a.criteria,b=i.criteria;return c<b?-1:c>b?1:0}),"value")};f.groupBy=function(a,c){var b={},d=f.isFunction(c)?c:function(a){return a[c]};
p(a,function(a,i){var c=d(a,i);(b[c]||(b[c]=[])).push(a)});return b};f.sortedIndex=function(a,c,b){b||(b=f.identity);for(var d=0,e=a.length;d<e;){var l=d+e>>1;b(a[l])<b(c)?d=l+1:e=l}return d};f.toArray=function(c){return!c?[]:c.toArray?c.toArray():f.isArray(c)||f.isArguments(c)?a.call(c):f.values(c)};f.size=function(a){return f.toArray(a).length};f.first=f.head=function(c,b,d){return null!=b&&!d?a.call(c,0,b):c[0]};f.initial=function(c,b,d){return a.call(c,0,c.length-(null==b||d?1:b))};f.last=function(c,
b,d){return null!=b&&!d?a.call(c,Math.max(c.length-b,0)):c[c.length-1]};f.rest=f.tail=function(c,b,d){return a.call(c,null==b||d?1:b)};f.compact=function(a){return f.filter(a,function(a){return!!a})};f.flatten=function(a,c){return f.reduce(a,function(a,i){if(f.isArray(i))return a.concat(c?i:f.flatten(i));a[a.length]=i;return a},[])};f.without=function(c){return f.difference(c,a.call(arguments,1))};f.uniq=f.unique=function(a,c,b){var b=b?f.map(a,b):a,d=[];f.reduce(b,function(b,e,l){if(0==l||(!0===
c?f.last(b)!=e:!f.include(b,e)))b[b.length]=e,d[d.length]=a[l];return b},[]);return d};f.union=function(){return f.uniq(f.flatten(arguments,!0))};f.intersection=f.intersect=function(c){var b=a.call(arguments,1);return f.filter(f.uniq(c),function(a){return f.every(b,function(c){return 0<=f.indexOf(c,a)})})};f.difference=function(c){var b=f.flatten(a.call(arguments,1));return f.filter(c,function(a){return!f.include(b,a)})};f.zip=function(){for(var c=a.call(arguments),b=f.max(f.pluck(c,"length")),d=
Array(b),e=0;e<b;e++)d[e]=f.pluck(c,""+e);return d};f.indexOf=function(a,c,b){if(null==a)return-1;var d;if(b)return b=f.sortedIndex(a,c),a[b]===c?b:-1;if(n&&a.indexOf===n)return a.indexOf(c);for(b=0,d=a.length;b<d;b++)if(b in a&&a[b]===c)return b;return-1};f.lastIndexOf=function(a,c){if(null==a)return-1;if(q&&a.lastIndexOf===q)return a.lastIndexOf(c);for(var b=a.length;b--;)if(b in a&&a[b]===c)return b;return-1};f.range=function(a,c,b){1>=arguments.length&&(c=a||0,a=0);for(var b=arguments[2]||1,d=
Math.max(Math.ceil((c-a)/b),0),e=0,f=Array(d);e<d;)f[e++]=a,a+=b;return f};var C=function(){};f.bind=function(c,b){var d,e;if(c.bind===w&&w)return w.apply(c,a.call(arguments,1));if(!f.isFunction(c))throw new TypeError;e=a.call(arguments,2);return d=function(){if(!(this instanceof d))return c.apply(b,e.concat(a.call(arguments)));C.prototype=c.prototype;var f=new C,l=c.apply(f,e.concat(a.call(arguments)));return Object(l)===l?l:f}};f.bindAll=function(c){var b=a.call(arguments,1);0==b.length&&(b=f.functions(c));
p(b,function(a){c[a]=f.bind(c[a],c)});return c};f.memoize=function(a,c){var b={};c||(c=f.identity);return function(){var d=c.apply(this,arguments);return f.has(b,d)?b[d]:b[d]=a.apply(this,arguments)}};f.delay=function(c,b){var d=a.call(arguments,2);return setTimeout(function(){return c.apply(c,d)},b)};f.defer=function(c){return f.delay.apply(f,[c,1].concat(a.call(arguments,1)))};f.throttle=function(a,c){var b,d,e,l,g,h=f.debounce(function(){g=l=!1},c);return function(){b=this;d=arguments;var f;e||
(e=setTimeout(function(){e=null;g&&a.apply(b,d);h()},c));l?g=!0:a.apply(b,d);h();l=!0}};f.debounce=function(a,c,b){var d;return function(){var e=this,f=arguments;b&&!d&&a.apply(e,f);clearTimeout(d);d=setTimeout(function(){d=null;b||a.apply(e,f)},c)}};f.once=function(a){var c=!1,b;return function(){if(c)return b;c=!0;return b=a.apply(this,arguments)}};f.wrap=function(c,b){return function(){var d=[c].concat(a.call(arguments,0));return b.apply(this,d)}};f.compose=function(){var a=arguments;return function(){for(var c=
arguments,b=a.length-1;0<=b;b--)c=[a[b].apply(this,c)];return c[0]}};f.after=function(a,c){return 0>=a?c():function(){if(1>--a)return c.apply(this,arguments)}};f.keys=D||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var c=[],b;for(b in a)f.has(a,b)&&(c[c.length]=b);return c};f.values=function(a){return f.map(a,f.identity)};f.functions=f.methods=function(a){var c=[],b;for(b in a)f.isFunction(a[b])&&c.push(b);return c.sort()};f.extend=function(c){p(a.call(arguments,1),function(a){for(var b in a)c[b]=
a[b]});return c};f.defaults=function(c){p(a.call(arguments,1),function(a){for(var b in a)null==c[b]&&(c[b]=a[b])});return c};f.clone=function(a){return!f.isObject(a)?a:f.isArray(a)?a.slice():f.extend({},a)};f.tap=function(a,c){c(a);return a};f.isEqual=function(a,c){return h(a,c,[])};f.isEmpty=function(a){if(null==a)return!0;if(f.isArray(a)||f.isString(a))return 0===a.length;for(var c in a)if(f.has(a,c))return!1;return!0};f.isElement=function(a){return!!(a&&1==a.nodeType)};f.isArray=e||function(a){return"[object Array]"==
l.call(a)};f.isObject=function(a){return a===Object(a)};f.isArguments=function(a){return"[object Arguments]"==l.call(a)};if(!f.isArguments(arguments))f.isArguments=function(a){return!(!a||!f.has(a,"callee"))};f.isFunction=function(a){return"[object Function]"==l.call(a)};f.isString=function(a){return"[object String]"==l.call(a)};f.isNumber=function(a){return"[object Number]"==l.call(a)};f.isNaN=function(a){return a!==a};f.isBoolean=function(a){return!0===a||!1===a||"[object Boolean]"==l.call(a)};
f.isDate=function(a){return"[object Date]"==l.call(a)};f.isRegExp=function(a){return"[object RegExp]"==l.call(a)};f.isNull=function(a){return null===a};f.isUndefined=function(a){return void 0===a};f.has=function(a,c){return u.call(a,c)};f.noConflict=function(){j._=g;return this};f.identity=function(a){return a};f.times=function(a,c,b){for(var d=0;d<a;d++)c.call(b,d)};f.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,
"&#x27;").replace(/\//g,"&#x2F;")};f.mixin=function(a){p(f.functions(a),function(c){E(c,f[c]=a[c])})};var F=0;f.uniqueId=function(a){var c=F++;return a?a+c:c};f.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var x=/.^/,y=function(a){return a.replace(/\\\\/g,"\\").replace(/\\'/g,"'")};f.template=function(a,c){var b=f.templateSettings,b="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+a.replace(/\\/g,"\\\\").replace(/'/g,
"\\'").replace(b.escape||x,function(a,c){return"',_.escape("+y(c)+"),'"}).replace(b.interpolate||x,function(a,c){return"',"+y(c)+",'"}).replace(b.evaluate||x,function(a,c){return"');"+y(c).replace(/[\r\n\t]/g," ")+";__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');",d=new Function("obj","_",b);return c?d(c,f):function(a){return d.call(this,a,f)}};f.chain=function(a){return f(a).chain()};var t=function(a){this._wrapped=a};f.prototype=t.prototype;
var z=function(a,c){return c?f(a).chain():a},E=function(b,d){t.prototype[b]=function(){var b=a.call(arguments);c.call(b,this._wrapped);return z(d.apply(f,b),this._chain)}};f.mixin(f);p("pop,push,reverse,shift,sort,splice,unshift".split(","),function(a){var c=b[a];t.prototype[a]=function(){var b=this._wrapped;c.apply(b,arguments);var d=b.length;("shift"==a||"splice"==a)&&0===d&&delete b[0];return z(b,this._chain)}});p(["concat","join","slice"],function(a){var c=b[a];t.prototype[a]=function(){return z(c.apply(this._wrapped,
arguments),this._chain)}});t.prototype.chain=function(){this._chain=!0;return this};t.prototype.value=function(){return this._wrapped}}).call(this);(function(h){var j=String.prototype.trim,g=function(a,c){for(var b=[];0<c;b[--c]=a);return b.join("")},d=function(a){return function(){for(var c=Array.prototype.slice.call(arguments),b=0;b<c.length;b++)c[b]=null==c[b]?"":""+c[b];return a.apply(null,c)}},b=function(){function a(a){return Object.prototype.toString.call(a).slice(8,-1).toLowerCase()}var c=
function(){c.cache.hasOwnProperty(arguments[0])||(c.cache[arguments[0]]=c.parse(arguments[0]));return c.format.call(null,c.cache[arguments[0]],arguments)};c.format=function(c,d){var e=1,h=c.length,k="",j=[],r,o,m,n;for(r=0;r<h;r++)if(k=a(c[r]),"string"===k)j.push(c[r]);else if("array"===k){m=c[r];if(m[2]){k=d[e];for(o=0;o<m[2].length;o++){if(!k.hasOwnProperty(m[2][o]))throw Error(b('[_.sprintf] property "%s" does not exist',m[2][o]));k=k[m[2][o]]}}else k=m[1]?d[m[1]]:d[e++];if(/[^s]/.test(m[8])&&
"number"!=a(k))throw Error(b("[_.sprintf] expecting number but found %s",a(k)));switch(m[8]){case "b":k=k.toString(2);break;case "c":k=String.fromCharCode(k);break;case "d":k=parseInt(k,10);break;case "e":k=m[7]?k.toExponential(m[7]):k.toExponential();break;case "f":k=m[7]?parseFloat(k).toFixed(m[7]):parseFloat(k);break;case "o":k=k.toString(8);break;case "s":k=(k=""+k)&&m[7]?k.substring(0,m[7]):k;break;case "u":k=Math.abs(k);break;case "x":k=k.toString(16);break;case "X":k=k.toString(16).toUpperCase()}k=
/[def]/.test(m[8])&&m[3]&&0<=k?"+"+k:k;o=m[4]?"0"==m[4]?"0":m[4].charAt(1):" ";n=m[6]-(""+k).length;o=m[6]?g(o,n):"";j.push(m[5]?k+o:o+k)}return j.join("")};c.cache={};c.parse=function(a){for(var c=[],b=[],d=0;a;){if(null!==(c=/^[^\x25]+/.exec(a)))b.push(c[0]);else if(null!==(c=/^\x25{2}/.exec(a)))b.push("%");else if(null!==(c=/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(a))){if(c[2]){var d=d|1,e=[],g=c[2],h=[];if(null!==(h=/^([a-z_][a-z_\d]*)/i.exec(g)))for(e.push(h[1]);""!==
(g=g.substring(h[0].length));)if(null!==(h=/^\.([a-z_][a-z_\d]*)/i.exec(g)))e.push(h[1]);else if(null!==(h=/^\[(\d+)\]/.exec(g)))e.push(h[1]);else throw"[_.sprintf] huh?";else throw"[_.sprintf] huh?";c[2]=e}else d|=2;if(3===d)throw"[_.sprintf] mixing positional and named placeholders is not (yet) supported";b.push(c)}else throw"[_.sprintf] huh?";a=a.substring(c[0].length)}return b};return c}(),e={VERSION:"2.0.0",isBlank:d(function(a){return/^\s*$/.test(a)}),stripTags:d(function(a){return a.replace(/<\/?[^>]+>/ig,
"")}),capitalize:d(function(a){return a.charAt(0).toUpperCase()+a.substring(1).toLowerCase()}),chop:d(function(a,c){for(var c=1*c||0||a.length,b=[],d=0;d<a.length;)b.push(a.slice(d,d+c)),d+=c;return b}),clean:d(function(a){return e.strip(a.replace(/\s+/g," "))}),count:d(function(a,c){for(var b=0,d,e=0;e<a.length;)d=a.indexOf(c,e),0<=d&&b++,e=e+(0<=d?d:0)+c.length;return b}),chars:d(function(a){return a.split("")}),escapeHTML:d(function(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,
"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}),unescapeHTML:d(function(a){return a.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&apos;/g,"'").replace(/&amp;/g,"&")}),escapeRegExp:d(function(a){return a.replace(/([-.*+?^${}()|[\]\/\\])/g,"\\$1")}),insert:d(function(a,c,b){a=a.split("");a.splice(1*c||0,0,b);return a.join("")}),include:d(function(a,c){return-1!==a.indexOf(c)}),join:d(function(a){var c=Array.prototype.slice.call(arguments);return c.join(c.shift())}),
lines:d(function(a){return a.split("\n")}),reverse:d(function(a){return Array.prototype.reverse.apply((""+a).split("")).join("")}),splice:d(function(a,c,b,d){a=a.split("");a.splice(1*c||0,1*b||0,d);return a.join("")}),startsWith:d(function(a,c){return a.length>=c.length&&a.substring(0,c.length)===c}),endsWith:d(function(a,c){return a.length>=c.length&&a.substring(a.length-c.length)===c}),succ:d(function(a){var c=a.split("");c.splice(a.length-1,1,String.fromCharCode(a.charCodeAt(a.length-1)+1));return c.join("")}),
titleize:d(function(a){for(var a=a.split(" "),c,b=0;b<a.length;b++)c=a[b].split(""),"undefined"!==typeof c[0]&&(c[0]=c[0].toUpperCase()),b+1===a.length?a[b]=c.join(""):a[b]=c.join("")+" ";return a.join("")}),camelize:d(function(a){return e.trim(a).replace(/(\-|_|\s)+(.)?/g,function(a,b,d){return d?d.toUpperCase():""})}),underscored:function(a){return e.trim(a).replace(/([a-z\d])([A-Z]+)/g,"$1_$2").replace(/\-|\s+/g,"_").toLowerCase()},dasherize:function(a){return e.trim(a).replace(/([a-z\d])([A-Z]+)/g,
"$1-$2").replace(/^([A-Z]+)/,"-$1").replace(/\_|\s+/g,"-").toLowerCase()},humanize:function(a){return e.capitalize(this.underscored(a).replace(/_id$/,"").replace(/_/g," "))},trim:d(function(a,c){if(!c&&j)return j.call(a);c=c?e.escapeRegExp(c):"\\s";return a.replace(RegExp("^["+c+"]+|["+c+"]+$","g"),"")}),ltrim:d(function(a,c){c=c?e.escapeRegExp(c):"\\s";return a.replace(RegExp("^["+c+"]+","g"),"")}),rtrim:d(function(a,c){c=c?e.escapeRegExp(c):"\\s";return a.replace(RegExp("["+c+"]+$","g"),"")}),truncate:d(function(a,
c,b){c=1*c||0;return a.length>c?a.slice(0,c)+(b||"..."):a}),prune:d(function(a,c,b){var d="",g="",g=0,h=[],b=b||"...",c=1*c||0,h=e.chars(a);for(g in h)d+=h[g].toUpperCase()!=h[g].toLowerCase()||/[-_\d]/.test(h[g])?"A":" ";g=0===d.substring(c-1,c+1).search(/^\w\w$/)?e.rtrim(d.slice(0,c).replace(/([\W][\w]*)$/,"")):e.rtrim(d.slice(0,c));g=g.replace(/\W+$/,"");return g.length+b.length>a.length?a:a.substring(0,g.length)+b}),words:function(a,c){return(""+a).split(c||" ")},pad:d(function(a,c,b,d){var e=
"",e=0,c=1*c||0;b?1<b.length&&(b=b.charAt(0)):b=" ";switch(d){case "right":e=c-a.length;e=g(b,e);a+=e;break;case "both":e=c-a.length;e={left:g(b,Math.ceil(e/2)),right:g(b,Math.floor(e/2))};a=e.left+a+e.right;break;default:e=c-a.length,e=g(b,e),a=e+a}return a}),lpad:function(a,c,b){return e.pad(a,c,b)},rpad:function(a,c,b){return e.pad(a,c,b,"right")},lrpad:function(a,c,b){return e.pad(a,c,b,"both")},sprintf:b,vsprintf:function(a,c){c.unshift(a);return b.apply(null,c)},toNumber:function(a,c){var b;
b=1*(1*a||0).toFixed(1*c||0)||0;return!(0===b&&"0"!==a&&0!==a)?b:Number.NaN},strRight:d(function(a,c){var b=!c?-1:a.indexOf(c);return-1!=b?a.slice(b+c.length,a.length):a}),strRightBack:d(function(a,c){var b=!c?-1:a.lastIndexOf(c);return-1!=b?a.slice(b+c.length,a.length):a}),strLeft:d(function(a,c){var b=!c?-1:a.indexOf(c);return-1!=b?a.slice(0,b):a}),strLeftBack:d(function(a,c){var b=a.lastIndexOf(c);return-1!=b?a.slice(0,b):a}),toSentence:function(a,c,b){c||(c=", ");b||(b=" and ");for(var d=a.length,
e="",g=0;g<d;g++)e+=a[g],g===d-2?e+=b:g<d-1&&(e+=c);return e},exports:function(){var a={},c;for(c in this)if(this.hasOwnProperty(c)&&!("include"==c||"contains"==c||"reverse"==c))a[c]=this[c];return a}};e.strip=e.trim;e.lstrip=e.ltrim;e.rstrip=e.rtrim;e.center=e.lrpad;e.ljust=e.lpad;e.rjust=e.rpad;e.contains=e.include;if("undefined"!==typeof exports){if("undefined"!==typeof module&&module.exports)module.exports=e;exports._s=e}else"undefined"!==typeof h._?(h._.string=e,h._.str=h._.string):h._={string:e,
str:e}})(this||window);(function(h){var j,g=h._.noConflict();if("undefined"!==typeof h.Klarna&&"undefined"===typeof h.Klarna._extend)throw Error("Klarna.js has already been defined");j={_extend:{},_namespace:"Klarna",_registeredNamespaces:{},_registeredNamespacesOrder:[],_initializedNamespaces:{},_stripKlarna:function(d){d=d.split(".");d[0]===j._namespace&&d.shift();return d.join(".")},Underscore:g,_:g,uid:function(d){return"klarna.uid."+(d?d+".":"")+(1073741824*Math.random()).toString(16)},initialize:function(){var d=
j.use("Event");g.each(j._registeredNamespacesOrder,function(b){var d=j._registeredNamespaces[b],a=j._extend[j._stripKlarna(b)],c=j.use("Event");"undefined"!==g.type(a)&&(c.trigger(c.makeName(["override",d]),d),j.extend(d,a));if("function"===g.type(d.init)){if("undefined"!==g.type(d._init))throw Error("Klarna.initialize would overwrite "+b+"._init (which is defined).");d.init();d._init=d.init;delete d.init}});this._initializedNamespaces=this._registeredNamespaces;this._registeredNamespaces={};this._registeredNamespacesOrder=
[];d.trigger(d.makeName(["done","initialize",j]))},use:function(d){return this.provide(d,void 0,!0)},provide:function(d,b,e){var a,c=j,h=d.split("."),b=b||{};h[0]===this._namespace&&h.shift();for(d=[this._namespace];h.length;)if(a=h.shift(),d.push(a),c[a]||(c[a]=h.length?{}:b),c=c[a],c._namespace=d.join("."),0===h.length&&!e){if("undefined"!==g.type(this._initializedNamespaces[c._namespace]))throw Error("You are attempting to provide a namespace twice. Use Klarna.extend or Klarna.use instead.");this._registeredNamespaces[c._namespace]||
(this._registeredNamespaces[c._namespace]=c,this._registeredNamespacesOrder.push(c._namespace))}return c},namespace:function(d,b){b=b||{};if("string"===g.type(d))return this.provide(d,b,!0);if("array"===g.type(d)){var e={};g.each(d,function(a){e[a]=this.provide(a,{},!0)},this);return e}},extend:function(){var d=Klarna.use("Event"),b=Array.prototype.slice.call(arguments),e=b.shift(),a=b.pop()||{},c;"string"===g.type(e)&&(e=j.use(e));c=e._namespace;"array"===g.type(a.mixin)&&(b=b.concat(a.mixin),delete a.mixin);
b.push(a);b.unshift(e);g.extendDeep.apply(this,b);e._namespace=c;d.trigger(d.makeName(["extended",e]),e);return e},absorb:function(d,b){var e=Klarna.use("Event"),a=b.split("."),c=a.pop(),l="jQuery"===c,j="Backbone"===c,a=a.join("."),b=Klarna.use(a||Klarna._namespace);b[c]=d;if(l)b.$=d,d.noConflict(!0),"jQuery"in h&&"undefined"===g.type(h.jQuery)&&delete h.jQuery,"$"in h&&"null"===g.type(h.$)&&delete h.$;else if(j)d.noConflict(),"Backbone"in h&&"undefined"===g.type(h.Backbone)&&delete h.Backbone;else try{delete h[c]}catch(v){}e.trigger(e.makeName(["absorbed",
c,b]),b)}};if("undefined"!==typeof h.Klarna&&"undefined"!==typeof h.Klarna._extend)j._extend=h.Klarna._extend;h.Klarna=j})(this);(function(h,j,g){var d=Klarna._;d.str.capitalizeFirst=function(b){return b.charAt(0).toUpperCase()+b.substring(1)};d.str.dottedNotationToRef=function(b,e){var a=b.split("."),c,g;for(g=e=e||h;a.length;)if(c=a.shift(),c in g&&"undefined"!==d.type(g[c]))g=g[c];else return;return g};d.mixin(d.str);d.mixin({keyOf:function(b,e){var a;d.any(b,function(c,b){return c===e?(a=b,!0):
!1});return a},type:function(b){return null===b||b===g?""+b:Object.prototype.toString.call(b).slice(8,-1).toLowerCase()||"object"},isWindow:function(b){var e=d.type(b);return d.contains(["global","domwindow","window"],e)||"object"===e&&"function"===d.type(b.setInterval)},isDocument:function(b){var e=d.type(b);return d.contains(["htmldocument","document"],e)||"object"===e&&"undefined"!==d.type(b.body)},isElement:function(b){return b&&"number"===d.type(b.nodeType)},isPlainObject:function(b){var e;if(!b||
"object"!==d.type(b)||b.nodeType||d.isWindow(b)||b.constructor&&!d.has(b,"constructor")&&!d.has(b.constructor.prototype,"isPrototypeOf"))return!1;for(e in b);return e===g||d.has(b,e)},clone:function(b){var e=d.isArray(b)?[]:{};return!d.isObject(b)?b:d.extendDeep(e,b)},extend:function(){var b=Array.prototype.slice.call(arguments);return d.extendDeep.apply(d,b)},extendDeep:function(){var b,e,a,c,g,h=arguments[0]||{},j=1,s=arguments.length,k=!0;"boolean"===d.type(h)&&(k=h,h=arguments[1]||{},j=2);for("object"!==
d.type(h)&&"function"!==d.type(h)&&"array"!==d.type(h)&&(h={});j<s;j++)if(null!==(b=arguments[j]))for(e in b)d.has(b,e)&&(a=h[e],c=b[e],h!==c&&(k&&c&&(d.isPlainObject(c)||(g=d.isArray(c)))?(g?(g=!1,a=a&&d.isArray(a)?a:[]):a=a&&d.isPlainObject(a)?a:{},h[e]=d.extendDeep(k,a,c)):"undefined"!==d.type(c)&&(h[e]=c)));return h},param:function(b,e){var a=[];d.each(b,function(c,b){b=e?e+"["+b+"]":b;c="function"===d.type(c)?c():c;a.push("object"===d.type(c)?d.param(c,b):h.encodeURIComponent(b)+"="+h.encodeURIComponent(c))});
return a.join("&").replace("%20","+")},unparam:function(b){var e={},a=h.decodeURIComponent;d.each(b.replace(/\+/g," ").split("&"),function(c){var f;var b=c.split("="),c=a(b[0]),b=a(b[1]||""),g=c.split("]["),h=g.length-1,j=0,k=e;if(c)if(0<=g[0].indexOf("[")&&/\]$/.test(g[h])?(g[h]=g[h].replace(/\]$/,""),g=g.shift().split("[").concat(g),h++):h=0,h)for(j=0;j<=h;j++)c=""!==g[j]?g[j]:k.length,j<h?(f=k[c]=k[c]||(isNaN(g[j+1])?{}:[]),k=f):k[c]=b;else"array"===d.type(e[c])?e[c].push(b):e[c]=c in e?[e[c],
b]:b});return e}})})(this,this.document);(function(h,j){var g=Klarna._;g.cookie={findAll:function(){var d={},b=h.decodeURIComponent;j.cookie&&g(j.cookie.split(";")).chain().map(function(b){return b.replace(/^\s+/,"").replace(/\s+$/,"")}).each(function(e){var e=e.split("="),a=e[0],c=null;1<g.size(e)&&(c=e.slice(1).join(""));d[b(a)]=b(c)});return d},find:function(d){return g.cookie.findAll()[d]},create:function(d,b,e){var a=new Date,e="undefined"===g.type(e)?864E5:1E3*e,a=new Date(a.getTime()+e),c=
h.encodeURIComponent,b=g.map({name:c(b),expires:a.toGMTString(),path:"/"},function(a,b){return["name"===b?c(d):b,a].join("=")}).join(";");j.cookie=b},destroy:function(d,b){(b=g.cookie.find(d))&&g.cookie.create(d,null,-1E6)}}})(this,this.document);(function(h){var j=Array.prototype.toJSON,g=q.stringify;if(h.Prototype&&"1.7">h.Prototype.Version)q.stringify=function(d,b,e){delete Array.prototype.toJSON;d=g(d,b,e);Array.prototype.toJSON=j;return d}})(this);Klarna.provide("Event");(function(){var h=Klarna._,
j=Klarna.use("Event");Klarna.extend(j,{_pile:{},_rePile:{},_index:{},_triggerCatch:{},_type:function(g){return-1<g.indexOf("*")?"regexp":"string"},makeName:function(g){var d;if(!g||"string"!==h.type(g[0]))throw Error("No event name was given");d=g.pop();("object"===h.type(d)||"function"===h.type(d))&&"string"===h.type(d._namespace)?(d=d._namespace.split(".").slice(1),(d=d.reverse().join(".").toLowerCase())&&g.push(d)):g.push(d);return g.join(":")},trigger:function(g,d,b){var e=h.clone(j._pile[g])||
{};h.each(j._rePile,function(a){h.each(a,function(a){a.event.test(g)&&(e[a.event]=a)})});h.each(j._triggerCatch,function(a,c){a(c,g,d,b,e)});if(h.isEmpty(e))return!1;h.each(e,function(a){a.callback.call(b,d,g,a,e);a.once&&j.unbind(a.event,a.id)});return!0},bind:function(g,d,b){var e=j._type(g),a="regexp"===e?j._rePile:j._pile,b=b||d.once||!1;a[g]=a[g]||{};a=a[g];g="regexp"===e?RegExp(g.replace(".","\\.").replace("*",".*")):g;e=Klarna.uid("event");a[e]=j._index[e]={id:e,event:g,once:b,callback:d,unbindCallback:d.unbind||
void 0};return e},once:function(g,d){return j.bind(g,d,!0)},onceMultiple:function(g,d,b){var e={},a={},c,l={},u;c=function(b,c,g,u){e[c]=Array.prototype.slice.call(arguments);e[c].unshift(this);delete a[c];0===h.size(a)&&(h.each(l,function(a,b){j.unbind(b,a)}),d.apply({},[e]))};u=function(){h.each(a,function(a,b){j.unbind(b,a)})};g=h.unique(g);b=h.unique(b);h.each(g,function(b){a[b]=j.bind(b,c,!0)});h.each(b,function(a){l[a]=j.bind(a,u,!0)});g=Klarna.uid("event");j._pile[g]=j._index[g]={id:g,event:"",
once:!0,callback:function(){},unbindCallback:function(){h.each(l,function(a,b){j.unbind(b,a)});h.each(a,function(a,b){j.unbind(b,a)})}};return g},on:function(g){var d={};h.each(g,function(b,e){d[e]=j.bind(e,b)});return d},onProxy:function(g){return function(d){var b={};h.each(d,function(d,a){b[j.makeName([a,g])]=d});return j.on.call(j,b)}},unbind:function(g,d){var b=("regexp"===j._type(g)?j._rePile:j._pile)[g]||{},e=!1,a=j._index,c=!1;if(h.isEmpty(b))return!1;h.each(b,function(g,j){d===j&&(c=!0);
if(d===j||d===g)"function"===h.type(b[j].unbindCallback)&&b[j].unbindCallback(),delete b[j],delete a[j],e=!0;if(c)return!1});return e},off:function(g){var d={};h.each(g,function(b,e){d[e]=j.unbind(e,b)});return d},offProxy:function(g){return function(d){var b={};h.each(d,function(d,a){b[j.makeName([a,g])]=d});return j.off.call(j,b)}}})})();Klarna.provide("Console");(function(h){var j=Klarna._,g=Klarna.use("Event"),d=Klarna.use("Console");Klarna.extend(d,{_console:j.extendDeep({},h.console),_flags:{critical:1,
error:2,debug:4,warn:8,info:16,log:32},_logging:!1,_reporting:!1,_reportingURI:"",_report:function(){if(!d._reportingURI)throw Error("Missing reporting URI for");},init:function(){var b,e,a,c,h,j=["error","debug","warn","info","log"],q="assert,clear,count,dir,dirxml,exception,group,groupCollapsed,groupEnd,time,timeEnd,timeStamp,profile,profileEnd,table,trace".split(","),s={},k=function(){};Error.stackTraceLimit=Infinity;c=function(a){return function(){var b=Array.prototype.slice.call(arguments),c=
d._logging;(!0===c||c&d._flags[a])&&d._console[a].apply(d,b);g.trigger(g.makeName([a,d]),b)}};h=function(a){return function(){var b=Array.prototype.slice.call(arguments);d._console[a].apply(d,b);g.trigger(g.makeName([a,d]),b)}};for(b=0,e=j.length;b<e;b++)a=j[b],s[a]=c(a),d._console[a]=d._console[a]||k;for(b=0,e=q.length;b<e;b++)a=q[b],s[a]=h(a),d._console[a]=d._console[a]||k;Klarna.extend(d,s)},critical:function(){var b=Array.prototype.slice.call(arguments);d.error.apply(d,b);b.unshift("Critical Error: "+
b[0]);throw Error.apply({},b.join(", "));},catchWindowErrors:function(){var b=h.onerror;h.onerror=function(e,a,c){d.error(e+" @"+a.replace(/\\/g,"/").replace(/.*\//,"")+":"+c);return"function"===j.type(b)?b(e,a,c):!1}}})})(this);Klarna.initialize();"function"===typeof define&&define.amd&&define("klarna/core",function(){return Klarna})})();
