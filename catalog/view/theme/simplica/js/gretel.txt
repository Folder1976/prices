"object"!=typeof JSON&&(JSON={}),function(){"use strict";function f(e){return e<10?"0"+e:e}function this_value(){return this.valueOf()}function quote(e){return rx_escapable.lastIndex=0,rx_escapable.test(e)?'"'+e.replace(rx_escapable,function(e){var t=meta[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var r,o,i,c,n,a=gap,u=t[e];switch(u&&"object"==typeof u&&"function"==typeof u.toJSON&&(u=u.toJSON(e)),"function"==typeof rep&&(u=rep.call(t,e,u)),typeof u){case"string":return quote(u);case"number":return isFinite(u)?String(u):"null";case"boolean":case"null":return String(u);case"object":if(!u)return"null";if(gap+=indent,n=[],"[object Array]"===Object.prototype.toString.apply(u)){for(c=u.length,r=0;r<c;r+=1)n[r]=str(r,u)||"null";return i=0===n.length?"[]":gap?"[\n"+gap+n.join(",\n"+gap)+"\n"+a+"]":"["+n.join(",")+"]",gap=a,i}if(rep&&"object"==typeof rep)for(c=rep.length,r=0;r<c;r+=1)"string"==typeof rep[r]&&(o=rep[r],i=str(o,u),i&&n.push(quote(o)+(gap?": ":":")+i));else for(o in u)Object.prototype.hasOwnProperty.call(u,o)&&(i=str(o,u),i&&n.push(quote(o)+(gap?": ":":")+i));return i=0===n.length?"{}":gap?"{\n"+gap+n.join(",\n"+gap)+"\n"+a+"}":"{"+n.join(",")+"}",gap=a,i}}var rx_one=/^[\],:{}\s]*$/,rx_two=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,rx_three=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,rx_four=/(?:^|:|,)(?:\s*\[)+/g,rx_escapable=/[\\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,rx_dangerous=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},Boolean.prototype.toJSON=this_value,Number.prototype.toJSON=this_value,String.prototype.toJSON=this_value);var gap,indent,meta,rep;"function"!=typeof JSON.stringify&&(meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=function(e,t,r){var o;if(gap="",indent="","number"==typeof r)for(o=0;o<r;o+=1)indent+=" ";else"string"==typeof r&&(indent=r);if(rep=t,t&&"function"!=typeof t&&("object"!=typeof t||"number"!=typeof t.length))throw new Error("JSON.stringify");return str("",{"":e})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(e,t){var r,o,i=e[t];if(i&&"object"==typeof i)for(r in i)Object.prototype.hasOwnProperty.call(i,r)&&(o=walk(i,r),void 0!==o?i[r]=o:delete i[r]);return reviver.call(e,t,i)}var j;if(text=String(text),rx_dangerous.lastIndex=0,rx_dangerous.test(text)&&(text=text.replace(rx_dangerous,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})),rx_one.test(text.replace(rx_two,"@").replace(rx_three,"]").replace(rx_four,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),function(e){"use strict";function t(){return x.useTest?"staging.cquotient.com":"cquotient.com"}function r(e){var t=[];for(var r in e)e.hasOwnProperty(r)&&t.push(r+"::"+e[r]);return t.join("||")}function o(e){for(var t=[],o=0;o<e.length;o++){var i=e[o];"[object Object]"===Object.prototype.toString.call(i)?t.push(r(i)):t.push(i)}return t.join(";;")}function i(){return document.cookie.indexOf("__cq_dnt=1")!==-1}function c(){try{for(var e=["cqcid","cquid","__cq_uuid","__cqact","__cqviews","__cq_bc","__cq_seg"],t=(e.length,document.cookie.split(";")),r=0,o=t.length;r<o;r++){var i=t[r],c=i.indexOf("="),n=(c>-1?i.substr(0,c):i).trim();e.indexOf(n)!==-1&&(document.cookie=n+"=; path=/; domain="+J+"; expires=Thu, 01 Jan 1970 00:00:00 GMT")}}catch(e){}}function n(e){for(var t,r=window.location.search.substring(1),o=r.split("&"),i=0,c=o.length;i<c;i++){var n=o[i].split("=");if(decodeURIComponent(n[0])===e){t=decodeURIComponent(n[1]);break}}return t}function a(e){var t=[];for(var i in e)if(e.hasOwnProperty(i)){var c=e[i],n=encodeURIComponent(i)+"=";n+="[object Object]"===Object.prototype.toString.call(c)?encodeURIComponent(r(c)):"[object Array]"===Object.prototype.toString.call(c)?encodeURIComponent(o(c)):encodeURIComponent(c),t.push(n)}return t.join("&").length<1e3&&t.push("json="+encodeURIComponent(JSON.stringify(e))),t.join("&")}function u(e){return decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1").replace(/\+/g,"%20"))||null}function s(e){var t,r;try{t=u("__cq_bc"),t||(t=u("bc")),t&&(t=t.replace(/^j:/,""),t=JSON.parse(t),r={},r[e]=t[e],r=JSON.stringify(r))}catch(e){}return r}function d(e,t){try{var r=window.sessionStorage.getItem("cq."+e);if(!r)return[];try{return JSON.parse(r)}catch(e){return[]}}catch(e){var o=u(t);if(!o)return[];try{return JSON.parse(o)}catch(e){return[]}}}function p(){return d("viewReco","__cqviews")}function f(){return d("viewSearch","__cqsviews")}function l(){return d("viewCategory","__cqcviews")}function v(e,t){var r=U[t.recommenderName]=U[t.recommenderName]||[];r.push(t.products),clearTimeout(E[t.recommenderName]),E[t.recommenderName]=window.setTimeout(function(){for(var o=[],i=0;i<r.length;i++)o=o.concat(r[i]);t.products=o,x.sendActivity(e,"viewReco",t);var c=p();c.push({recommenderName:t.recommenderName,cookieId:t.cookieId,userId:t.userId,products:t.products});try{window.sessionStorage.setItem("cq.viewReco",JSON.stringify(c))}catch(t){var n=encodeURIComponent(JSON.stringify(c));n.length>1e3?x.sendActivity(e,"error",{time:(new Date).getTime(),error:"__cqviews too large"}):document.cookie="__cqviews="+encodeURIComponent(JSON.stringify(c))+";path=/;"}},0)}function m(e,t){var r=D[t.searchText]=D[t.searchText]||[];r.push(t.products),clearTimeout(P[t.searchText]),P[t.searchText]=window.setTimeout(function(){for(var o=[],i=0;i<r.length;i++)o=o.concat(r[i]);t.products=o,x.sendActivity(e,"viewSearch",t),D[t.searchText]=[];var c=f();c.push({searchText:t.searchText,refinements:t.refinements,cookieId:t.cookieId,userId:t.userId,products:t.products});try{window.sessionStorage.setItem("cq.viewSearch",JSON.stringify(c))}catch(t){var n=encodeURIComponent(JSON.stringify(c));n.length>1e3?x.sendActivity(e,"error",{time:(new Date).getTime(),error:"__cqsviews too large"}):document.cookie="__cqsviews="+encodeURIComponent(JSON.stringify(c))+";path=/;"}},0)}function g(e,t){var r=t.categoryId,o=M[r]=M[r]||[];o.push(t.products),clearTimeout(F[r]),F[r]=window.setTimeout(function(){for(var i=[],c=0;c<o.length;c++)i=i.concat(o[c]);t.products=i,x.sendActivity(e,"viewCategory",t),M[r]=[];var n=l();n.push({refinements:t.refinements,categoryId:t.categoryId,cookieId:t.cookieId,userId:t.userId,products:t.products});try{window.sessionStorage.setItem("cq.viewCategory",JSON.stringify(n))}catch(t){var a=encodeURIComponent(JSON.stringify(n));a.length>1e3?x.sendActivity(e,"error",{time:(new Date).getTime(),error:"__cqcviews too large"}):document.cookie="__cqcviews="+encodeURIComponent(JSON.stringify(n))+";path=/;"}},0)}function h(e,t){for(var r=0;r<V.length;r++)for(var o=V[r].products,i=0;i<o.length;i++)if(o[i].id===t.id){var c={recommenderName:V[r].recommenderName,product:t,cookieId:V[r].cookieId,userId:V[r].userId};return void x.sendActivity(e,"_clickReco",c)}}function y(e,t){for(var r=0;r<Q.length;r++)for(var o=Q[r].products,i=0;i<o.length;i++)if(o[i].id===t.id){var c={searchText:Q[r].searchText,refinements:Q[r].refinements,product:t,cookieId:Q[r].cookieId,userId:Q[r].userId};return void x.sendActivity(e,"clickSearch",c)}}function w(){try{return window.localStorage.setItem("cq","cq"),window.localStorage.removeItem("cq"),!0}catch(e){return!1}}function _(e,t){for(var r=0;r<$.length;r++)for(var o=$[r].products,i=0;i<o.length;i++)if(o[i].id===t.id){var c={refinements:$[r].refinements,product:t,categoryId:$[r].categoryId,cookieId:$[r].cookieId,userId:$[r].userId};return void x.sendActivity(e,"clickCategory",c)}}function I(){return!!(x.activities&&x.activities.length>0)||!!u("__cqact")}function k(e,t,r,o){var i={clientId:e,activityType:t,params:r,callback:o};C.push(i)}function S(){for(var e=0,t=C.length;e<t;e++){var r=C[e];x.sendActivity(r.clientId,r.activityType,r.params,r.callback)}C=[]}function T(){return!!u("__cq_uuid")}function O(){if(x.clientId)try{var e=u("__cqact");if(!e)return void window.setTimeout(O,100);var t=JSON.parse(e);if(!t[0])return document.cookie="__cqact=; path=/; expires=Thu, 01 Jan 1970 00:00:00 UTC",void window.setTimeout(O,100);x.sendActivity(x.clientId,t[0].activityType,t[0].parameters,function(){b(t[0])})}catch(e){x.sendActivity(x.clientId,"error",{time:(new Date).getTime(),caughtError:e}),document.cookie="__cqact=; path=/; expires=Thu, 01 Jan 1970 00:00:00 UTC"}}function b(e){try{var t=u("__cqact");if(!t)return void O();for(var r=JSON.stringify(e.parameters.product||e.parameters.products),o=JSON.parse(t),i=0,c=o.length;i<c;i++)if(o[i].activityType===e.activityType&&JSON.stringify(o[i].parameters.product||o[i].parameters.products)===r){if(o.splice(i,1),document.cookie="__cqact="+encodeURIComponent(JSON.stringify(o))+"; path=/;",JSON.parse(u("__cqact")).length===c)throw new Error("error deleting activity cookie");break}O()}catch(e){x.sendActivity(x.clientId,"error",{time:(new Date).getTime(),caughtError:e}),document.cookie="__cqact=; path=/; expires=Thu, 01 Jan 1970 00:00:00 UTC"}}function q(e){e=e.toLowerCase();for(var t=0;t<G.length;t++){var r=G[t];if(e.indexOf(r)>=0)return r}return"other"}var x=e.CQuotient=window.CQuotient||(e.CQuotient={});x.VERSION="v2.9.8";var N=0,C=[],R=!0,j=!1;x._getTopDomain=function(e){var t,r,o="weird_get_top_level_domain=cookie",i=e.split(".");for(t=i.length-1;t>=0;t--)if(r=i.slice(t).join("."),document.cookie=o+";domain=."+r+";",document.cookie.indexOf(o)>-1)return document.cookie=o.split("=")[0]+"=;domain=."+r+";expires=Thu, 01 Jan 1970 00:00:01 GMT;","."+r;return!1};var J=x._getTopDomain(document.location.hostname),A={customerSignup:["cookieId","userId","emailId"],viewPage:["cookieId","pageId"],viewProduct:["cookieId","product"],search:["cookieId","searchText"],viewSearch:["cookieId","searchText","products"],clickSearch:["cookieId","searchText","product"],viewCategory:["cookieId","categoryId"],clickCategory:["cookieId","categoryId"],viewCart:["cookieId","products"],addToCart:["cookieId","product"],removeFromCart:["cookieId","product"],beginCheckout:["cookieId","products","amount"],finishCheckout:["cookieId","products","amount"],reviewProduct:["cookieId","product","rating"],clickReco:["cookieId","product"],_clickReco:["cookieId","product"],viewWishList:["cookieId"],addToWishList:["cookieId"],removeFromWishList:["cookieId"],viewReco:["cookieId"],servedReco:[],error:[]},U={},E={},D={},P={},M={},F={},V=p();try{window.sessionStorage.removeItem("cq.viewReco")}catch(e){document.cookie="__cqviews=;path=/;"}var Q=f();try{window.sessionStorage.removeItem("cq.viewSearch")}catch(e){document.cookie="__cqsviews=;path=/;"}var $=l();try{window.sessionStorage.removeItem("cq.viewCategory")}catch(e){document.cookie="__cqcviews=;path=/;"}var L=!1;if(window.setTimeout(function(){L||!x.clientId||I()||x.sendActivity(x.clientId,"viewPage",{cookieId:u("cqcid")})},1e3),x.sendActivity=function(e,r,o,d){function p(){delete x[q],U.parentNode.removeChild(U)}if(i())return c(),new Image;if(!e)throw new Error("Must provide a clientId");if(!A.hasOwnProperty(r))throw new Error("Unsupported activity type!");if(L=!0,o=o||{},"viewReco"===r&&o.accumulate)return delete o.accumulate,void v(e,o);if("viewSearch"===r&&o.accumulate)return delete o.accumulate,void m(e,o);if("viewCategory"===r&&o.accumulate)return delete o.accumulate,void g(e,o);if("viewProduct"===r&&(h(e,o.product),y(e,o.product),_(e,o.product)),!("clickReco"===r&&V.length>0)){var f=n("__cq_eid");f&&(o.emailId=f),"_clickReco"===r&&(r="clickReco"),o.referrer=window.document.referrer;var l=u("__cq_uuid");l&&(o.__cq_uuid=l);var I=u("__cq_seg");I&&(o.__cq_seg=I);var O="https://p."+t()+"/pebble?tla="+e+"&activityType="+r,b=s(e);b&&(o.bc=b),o.ls=w(),O+="&_="+(new Date).getTime();var q="_act_callback"+N++;O+="&callback=CQuotient."+q,o.v=x.VERSION;var C=a(o);if(C.length>0&&(O+="&"+C),!T()&&!j){if(!R)return void k(e,r,o,d);R=!1}var U=document.createElement("script");return U.src=O,U.type="text/javascript",x[q]=function(e){if("[object Object]"===Object.prototype.toString.call(e)&&(e=[e]),"[object Array]"===Object.prototype.toString.call(e))for(var t=0,r=e.length;t<r;t++)document.cookie=e[t].k+"="+e[t].v+";path=/;domain="+(J||e[t].d)+";max-age="+e[t].m;T()||(j=!0),S(),p(),d&&d()},document.getElementsByTagName("body")[0].appendChild(U),new Image}},x.clientId&&x.activities&&x.activities.length>0){for(var B=0;B<x.activities.length;B++){var W=x.activities[B];x.sendActivity(x.clientId,W.activityType,W.parameters)}x.activities=[]}O();var G=["ipad","iphone","android","windows","mac"],H={pdp:!0,topsellers:!0,v2v:!0};if(x.getRecs=function(e,r,o,i,c){function n(){delete x[g],I.parentNode.removeChild(I),window.clearTimeout(k)}var d=new Date;if(!e)return void(c&&c({errorMessage:'Invalid value for "clientId":'+e}));if(!r)return void(c&&c({errorMessage:'Invalid value for "recommenderName":'+r}));o=o||{};var p=u("__cq_uuid");p&&(o.__cq_uuid=p);var f=!1;for(var l in H)H.hasOwnProperty(l)&&r.indexOf(l)>=0&&(f=H[l]);var v,m=o.timeoutMs||5e3,g="_callback"+N++,h="recs/"+e+"/"+r+"?callback=CQuotient."+g;if(f?v="r":(h+="&_="+(new Date).getTime(),v="e"),o.filters){var y=o.filters;delete o.filters,y.fieldsToMatchToValue&&(o.filter_fieldsToMatchToValue=y.fieldsToMatchToValue)}o.v=x.VERSION,h+="&_device="+q(navigator.userAgent);var w=s(e);w&&(o.bc=w);var _=a(o);_.length>0&&(h+="&"+_);var I=document.createElement("script");I.src="//"+v+"."+t()+"/"+h,I.type="text/javascript";var k=window.setTimeout(function(){try{c&&c({errorMessage:"Reco request timed out for recommender: "+r})}finally{n()}},m);x[g]=function(t){try{if("[object Object]"===Object.prototype.toString.call(t))try{i(t)}catch(r){x.sendActivity(e,"error",{time:new Date-d,recoRequestParams:o,recoResponse:t,caughtError:r})}finally{x.sendActivity(e,"servedReco",{time:new Date-d,recoRequestParams:o,recoResponse:t})}else if(c)try{c(t)}finally{x.sendActivity(e,"error",{time:new Date-d,recoRequestParams:o,recoResponse:t})}}catch(r){x.sendActivity(e,"error",{time:new Date-d,recoRequestParams:o,recoResponse:t,caughtError:r})}finally{n()}},document.getElementsByTagName("body")[0].appendChild(I)},x.clientId&&x.widgets&&x.widgets.length>0){for(var Y=0;Y<x.widgets.length;Y++){var Z=x.widgets[Y];x.getRecs(x.clientId,Z.recommenderName,Z.parameters,Z.callback,Z.errorCallback)}x.widgets=[]}}("undefined"!=typeof module&&module.exports?exports:window);
